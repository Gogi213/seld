<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Lightweight Charts</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #111;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        #chart {
            width: 600px;
            height: 400px;
            margin: 20px 0;
            border: 1px solid #333;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background: #0a4d0a; }
        .error { background: #4d0a0a; }
        .info { background: #0a2a4d; }
    </style>
</head>
<body>
    <h1>üß™ Test Lightweight Charts</h1>
    <div id="status" class="status info">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    
    <div id="chart"></div>
    
    <div id="details"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const chartDiv = document.getElementById('chart');
        const detailsDiv = document.getElementById('details');

        function log(message, type = 'info') {
            console.log(message);
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            detailsDiv.appendChild(div);
        }

        async function testChart() {
            try {
                log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç lightweight-charts...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                if (typeof window === 'undefined') {
                    throw new Error('–ù–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
                }
                log('‚úÖ –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è —Å—Ä–µ–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');

                // –ü—ã—Ç–∞–µ–º—Å—è –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
                log('üì¶ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º lightweight-charts...');
                const { createChart } = await import('https://unpkg.com/lightweight-charts@4.2.3/dist/lightweight-charts.standalone.production.js');
                
                if (!createChart) {
                    throw new Error('createChart –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                log('‚úÖ createChart –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω');

                // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
                log('üé® –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫...');
                const chart = createChart(chartDiv, {
                    width: 600,
                    height: 400,
                    layout: {
                        background: { color: '#111' },
                        textColor: '#DDD',
                    },
                    grid: {
                        vertLines: { color: '#222' },
                        horzLines: { color: '#222' },
                    },
                });

                if (!chart) {
                    throw new Error('–ì—Ä–∞—Ñ–∏–∫ –Ω–µ —Å–æ–∑–¥–∞–ª—Å—è');
                }
                log('‚úÖ –ì—Ä–∞—Ñ–∏–∫ —Å–æ–∑–¥–∞–Ω');

                // –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ä–∏—é
                log('üìà –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ...');
                const series = chart.addCandlestickSeries();
                
                // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                const testData = [
                    { time: '2023-12-01', open: 100, high: 110, low: 95, close: 105 },
                    { time: '2023-12-02', open: 105, high: 115, low: 100, close: 108 },
                    { time: '2023-12-03', open: 108, high: 120, low: 102, close: 112 },
                    { time: '2023-12-04', open: 112, high: 118, low: 106, close: 115 },
                    { time: '2023-12-05', open: 115, high: 125, low: 110, close: 120 },
                ];

                series.setData(testData);
                log('‚úÖ –î–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã');

                statusDiv.textContent = 'üéâ –¢–ï–°–¢ –ü–†–û–®–ï–õ –£–°–ü–ï–®–ù–û!';
                statusDiv.className = 'status success';
                
                log('üéØ –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç! lightweight-charts –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω', 'success');

            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞:', error);
                statusDiv.textContent = `‚ùå –û–®–ò–ë–ö–ê: ${error.message}`;
                statusDiv.className = 'status error';
                
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                log(`üìã Stack: ${error.stack}`, 'error');
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
        testChart();
    </script>
</body>
</html>
